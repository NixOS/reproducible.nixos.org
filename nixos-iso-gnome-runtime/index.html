<html>
<head>
<title>Is nixos.<wbr>iso_gnome.<wbr>x86_64-linux reproducible?</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="nixos-unstable's nixos.<wbr>iso_gnome.<wbr>x86_64-linux build is 99.03% reproducible!" />

<!-- Twitter Card data -->
<meta name="twitter:card" value="summary">

<!-- Open Graph data -->
<meta property="og:title" content="Is nixos.<wbr>iso_gnome.<wbr>x86_64-linux Reproducible?" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://reproducible.nixos.org/" />
<meta property="og:image" content="https://reproducible.nixos.org/nixos-rb-logo.png" />
<meta property="og:description" content="nixos-unstable's nixos.<wbr>iso_gnome.<wbr>x86_64-linux build is 99.03% reproducible!" />
<link rel="stylesheet" href="../styles/index.css">
<style>
body {
      padding: 3em;
}
</style>
</head>
<body>
<h1>Is nixos.<wbr>iso_gnome.<wbr>x86_64-linux Reproducible?</h1>
<i>Tracking the build closure for <code>nixos.<wbr>iso_gnome.<wbr>x86_64-linux</code> in the <code>nixos-unstable</code>
    branch on <code>x86_64-linux</code>.</i>
<p>
To run the check build manually:
<pre>
nix-build /nix/store/???.drv --check --keep-failed
</pre>
<!--nix-build ./nixos/release-combined.nix -A nixos.<wbr>iso_gnome.<wbr>x86_64-linux-->
And to find out why a derivation is part of the build closure, use:
<pre>
git clone https://github.com/nixos/nixpkgs.git
cd nixpkgs
git checkout 9b19f5e77dd906cb52dade0b7bd280339d2a1f3d
nix-store -q --tree $(nix-instantiate nixos/release-combined.nix -A nixos.<wbr>iso_gnome.<wbr>x86_64-linux)
</pre>

<h2>1332 out of 1345 (99.03%)</h2>
<p>paths in the nixos.<wbr>iso_gnome.<wbr>x86_64-linux build closure are reproducible! 6 paths remained unchecked</p>
<h3>unreproduced paths</h3>
<p>These derivations produced a different result compared to the official cache, revealing a reproducibility problem. See the <a href="https://github.com/orgs/NixOS/projects/30/views/1">Project</a> for progress on fixing those, or <a href="https://github.com/NixOS/nixpkgs/issues/new?assignees=&labels=0.kind%3A+enhancement%2C6.topic%3A+reproducible+builds&template=unreproducible_package.md&title=">add an issue</a> for those that are not tracked yet.</p>
<ul>
<li><a href="file:///nix/store/ndkhky8zvbdc7ppalbqg5wscd0cb27kb-wireplumber-0.4.17.drv"><code>wireplumber-0.4.17.drv</code></a>
doc <a href="./diff/c9ccf9b91faf66e5f3174e226e8a476ad7046b4d5bf15f2af3e0481c1338b614-a908ee10e5b46bdd597577ada2d6706bd3c0133786f3b86e2f45b04ec9f9e263.html">(diffoscope)</a>
</ul></li>
<li><a href="file:///nix/store/qcac54nz4bhfmx94sc89hr5pxs28ddww-qemu-host-cpu-only-8.2.0.drv"><code>qemu-host-cpu-only-8.2.0.drv</code></a>
out <a href="./diff/a8c7850d15db1d859adc22679ead7d7d00484dde2b5bd409714656d0c70ab1e7-eada47510d235801042a789c482f34acac64f36ee759a229a6a216f3b2e31df2.html">(diffoscope)</a>
</ul></li>
<li><a href="file:///nix/store/xhgyjdwaidm73vydixz1hwr20mv5qws3-pipewire-1.0.0.drv"><code>pipewire-1.0.0.drv</code></a>
doc <a href="./diff/5cb87c63c78de426e57c409236df5f162787c5cb614c9d9aa119cc8950992fc4-19c1939e4149585cfcd27724aa3d834fa4c39b23c049fafb4f4aff57f1bbe4db.html">(diffoscope)</a>
</ul></li>
<li><a href="file:///nix/store/jbbzl0il9jyjcdv0zqd9fgv1vhlw1qia-phonenumber-8.12.37.drv"><code>phonenumber-8.12.37.drv</code></a>
out <a href="./diff/888f03962a8ac95f9935c4b4742cc6b40eb7d15c270b862764471528d1fbb934-640dcfb66172b285b3dc1dd398207f874b7875673a21ad137c37aa220232a4b8.html">(diffoscope)</a>
</ul></li>
<li><a href="file:///nix/store/f1zkac03vs9wp818m17prhfvyzs324xa-loupe-45.3.drv"><code>loupe-45.3.drv</code></a>
out <a href="./diff/0d40b1d37a189318f097a1d9fffa2d78a4a2c994b9f118335952ea80a0ce1acf-fded06d6f59d02f3080fb9b8b826e7755f8b7f81362b8967f8bee2d2caa7fb97.html">(diffoscope)</a>
</ul></li>
<li><a href="file:///nix/store/bk88zwab1lx7s48j2hgkg9jlc3rkwpck-libcamera-0.0.5.drv"><code>libcamera-0.0.5.drv</code></a>
out <a href="./diff/ca6a6c175d00d0d339adf9e2936a13f8ed3022f5f962bb230a6f58f07e0c0952-77efcdf3af00279338cf4bfa507ce57839aa38153d631243eabb8728f1e741d5.html">(diffoscope)</a>
</ul></li>
<li><a href="file:///nix/store/ypmszf2zg8pyk6n1xa152k5psa2k6kk4-ibus-1.5.28.drv"><code>ibus-1.5.28.drv</code></a>
out <a href="./diff/9a4f2bad3004924aaaf680ec1d54eb3a3b7d4fe0a3bc7153d4f93e28bb70a928-bed1a5952cd2279496919a09b1fba857eb2a0c4e9596113eeab9f9375860d405.html">(diffoscope)</a>
</ul></li>
</ul>
<hr>
<h3>unchecked paths</h3>
<ul>
<li><a href="/nix/store/2zyfvmgxp8afxkc97n2gpnqbkzrz08ir-cantarell-fonts-0.303.1.drv"><code>cantarell-fonts-0.303.1.drv</code></a></li>
<li><a href="/nix/store/ar0kwdrjd880w1f3jbbygadak9qhshfp-xdg-desktop-portal-1.18.2.drv"><code>xdg-desktop-portal-1.18.2.drv</code></a></li>
<li><a href="/nix/store/r39zp4yhcq4pa4rbpy4l41kmr96vni9v-spidermonkey-115.2.0.drv"><code>spidermonkey-115.2.0.drv</code></a></li>
<li><a href="/nix/store/3wrdaxrpm8333assqixldvh60j8vpfz7-gst-plugins-good-1.22.8.drv"><code>gst-plugins-good-1.22.8.drv</code></a></li>
<li><a href="/nix/store/wx45g16ny88v011gdpl9wgc2g712316n-linux-6.1.72.drv"><code>linux-6.1.72.drv</code></a></li>
<li><a href="/nix/store/83lv0lyaixbcf1ak3nq93kk02mdb8kfs-folks-0.15.7.drv"><code>folks-0.15.7.drv</code></a></li>
</ul>

<hr />
<h3 id="test-circumstance">How are these tested?</h3>
<p>Each build is run twice, at different times, on different hardware

running different kernels.</p>

<h3 id="result-confidence">How confident can we be in the results?</h3>

<p>Fairly. We don't currently inject randomness at the filesystem
layer, but many of the reproducibility issues are being exercised
already. It isn't possible to <em>guarantee</em> a package is
reproducible, just like it isn't possible to prove software is
bug-free. It is possible there is nondeterminism in a package source,
waiting for some specific circumstance.</p>

<p>This is why we run these tests: to track how we are doing over
time, to submit bug fixes for nondeterminism when we find them.</p>

<h3 id="help">How can I help?</h3>

<ul>
<li>Look at the <a href="https://github.com/orgs/NixOS/projects/30">project page</a>, <a href="https://github.com/NixOS/nixpkgs/issues?q=is%3Aopen+is%3Aissue+label%3A%226.topic%3A+reproducible+builds%22">issues</a> and <a href="https://github.com/NixOS/nixpkgs/pulls?q=is%3Aopen+is%3Apr+label%3A%226.topic%3A+reproducible+builds%22">pull requests</a> with the 'reproducible builds' label.</li>
<li>Open new issues/PR's for reproducibility problems (like the ones reported above)</li>
<li>Join the <a href="https://matrix.to/#/#reproducible-builds:nixos.org">#reproducible-builds:nixos.org</a> room on Matrix</li>
</ul>

<h3 id="next-steps">How can we do better?</h3>

<p>There are further steps we could take. For example, the next likely
step is using
<a href="https://salsa.debian.org/reproducible-builds/disorderfs">disorderfs</a>
which injects additional nondeterminism by reordering directory entries.
</p>

<h3 id="how-do-i-check">How can I test my patches?</h3>
<p>Nix has built-in support for checking a path is reproducible. There
are two routes.</p>

<p>Pretending you are debugging a nondeterminism bug in
<code>hello</code>. To check it, you build the package, and then
build it again with <code>--check --keep-failed</code>. This will
provide the differing output in a separate directory which you can
use <code>diffoscope</code> on.</p>

<pre>
$ nix-build . -A hello
$ nix-build . -A hello --check --keep-failed
[...snip...]
error: derivation '/nix/store/...hello.drv' may not be deterministic:
output '/nix/store/...-hello' differs from '/nix/store/...hello.check'
$ diffoscope /nix/store/...hello /nix/store/...hello.check
</pre>

<p>Note: the <code>.check</code> output is not a valid store path, and
will automatically be deleted on the next run of the Nix garbage
collector.</p>

<p><small>There is support for an automatic <code>diff-hook</code> in
Nix 2, but it is much more complicated to set up. If you would like to
work on this, or need help setting it up,
<a href="https://matrix.to/#/!LemuOOvbWqRXodtSsw:nixos.org?via=nixos.org&via=matrix.org">contact us on Matrix.</a>
We can work together to write docs on how to use it.</small>
</p>

<hr />

<small>Generated at 2024-01-15 16:19:56.190082717 UTC from <a href="https://codeberg.org/raboof/nix-reproducible-builds-report">https://codeberg.org/raboof/nix-reproducible-builds-report</a> (heavily based on <a href="https://github.com/grahamc/r13y.com">https://github.com/grahamc/r13y.com</a>).</small>
<center><img style="max-width: 100px" src="https://nixos.org/logo/nixos-logo-only-hires.png" /></center>
</body></html>
